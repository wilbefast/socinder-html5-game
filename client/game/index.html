<html>

  <div style="display:none">
	<img id="center" src="/images/center.png" />
    <img id="citizen_me" src="/images/citizen_me.png" />
    <img id="citizen_unknown" src="/images/citizen_unknown.png" />
    <img id="citizen_friend" src="/images/citizen_friend.png" />
    <img id="citizen_enemy" src="/images/citizen_enemy.png" />
 	</div>

<canvas width="1280" height="728">
</canvas>

	<script type="text/javascript" src="/js/jquery.js"></script>

  <script type="text/javascript">
    window.onload = function() {



		var center = document.getElementById("center");
    	var citizen_me = document.getElementById("citizen_me");
    	var citizen_unknown = document.getElementById("citizen_unknown");
    	var citizen_friend = document.getElementById("citizen_friend");
    	var citizen_enemy = document.getElementById("citizen_enemy");
		 
		var canvas = document.getElementsByTagName("canvas")[0];
		var radius = Math.min(canvas.width,canvas.height) * 0.5;
		var radiusOuter = radius * 0.8;		
		var drawSize = 32;
		
		var ctx = canvas.getContext("2d");
		ctx.drawImage(center, canvas.width * 0.5 -drawSize, canvas.height * 0.5 -drawSize, drawSize, drawSize);
		
		$.getJSON("_map?citizen=John", {
		    format: "json"
		  }).done(function( data ){
		 
		 var myDistanceToNorm = data.distanceFromNorm.__me__;
		  
		  ctx.drawImage(citizen_me, canvas.width * 0.5 -drawSize, canvas.height * 0.5 + radius * myDistanceToNorm-drawSize, drawSize, drawSize);
		  
	      console.log(data);
	      console.log("MY DISTANCE FROM SOCIETY NORM", data.distanceFromNorm.__me__);
		  
		  data.distanceFromOther.Bob = 0.5;
		  
		  var left = Math.random() > 0.5 ? 1 : 0;
		  
		  for(var name in data.distanceFromOther) {
		  
			left = left % 2;
			console.log("name", name);
		    console.log("distance from me", data.distanceFromOther[name]);
			console.log("distance from norm", data.distanceFromNorm[name]);
			//ctx.drawImage(citizen_unknown, (canvas.width * 0.5) - (drawSize * (-1+left*2)) + (-1+left*2) * data.distanceFromNorm[name] * radius, radius * Math.sin(data.distanceFromOther[name] * Math.PI),drawSize,drawSize);
			ctx.drawImage(citizen_unknown,
			(canvas.width * 0.5) - (drawSize * (-1+left*2)) + (-1+left*2) * (data.distanceFromNorm[name] * radius * Math.cos((0.5+data.distanceFromOther[name]) * Math.PI)),
			(canvas.height	 * 0.5) + data.distanceFromNorm[name] * radius * Math.sin((0.5+data.distanceFromOther[name]) * Math.PI),drawSize,drawSize);
			
			left++;
		  }
	    });
		
		
		

		//ctx possesses distanceToNorm & distanceToPlayer
		
    }
	

  </script>

</html>